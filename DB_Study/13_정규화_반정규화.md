# 13_정규화, 반정규화

| 정규화(normalization)           | 반정규화(denormalization)            |
| ------------------------------- | ------------------------------------ |
| 데이터 중복을 최소화하도록 설계 | 읽기(SELECT) 시간 최적화를 위한 설계 |
| 일관성 있는 데이터              | 일관성이 떨어지는 데이터             |
| 유연성 높음                     | 유연성 낮음                          |

**간단한 정규화 - 반정규화 예시**

![image](https://user-images.githubusercontent.com/93081720/225668118-774e5eab-1cd7-49b4-aceb-24a45dda6635.png)

<br>

## 1. 정규화(normalization)

> 관계형 데이터베이스에서 `불필요한 데이터 제거 및 중복을 최소화`하기 위해 데이터를 구조화하는 작업

하나의 종속성이 하나의 관계(릴레이션)에 표현될 수 있도록 `분해`해 가는 과정

### 장점

- 데이터베이스 변경 시 이상 현상(Anomaly) 제거
  - 삽입 이상: 새로운 데이터를 삽입하기 위해 불필요한 데이터도 삽입해야 하는 문제
  - 갱신 이상: 중복 튜플 중 일부만 변경하여 데이터가 불일치하게 되는 모순의 문제
  - 삭제 이상: 튜플을 삭제하면 꼭 필요한 데이터까지 함께 삭제되는 데이터 손실 문제
- 데이터 저장 공간의 최소화 가능
- 효과적인 검색 알고리즘 생성 가능
  - 다른 테이블을 거쳐서 조회해야 하므로 최적화된, 효율적인 검색 알고리즘을 짜게 됨
- 데이터 구조의 안정성 및 무결성 유지

### 단점

- 데이터 테이블 간의 JOIN 연산 증가
  - 데이터 조회에 대한 성능 저하(질의 응답 시간 증가)

### 정규화 과정(정규형)

- 제 1정규형(1NF), 제 2정규형(2NF), 제 3정규형(3NF), BCNF형, 제 4정규형, 제 5정규형이 존재
  - 차수가 높아질 수록 만족시켜야 할 제약 조건이 늘어남

<br>

## 2. 반정규화(denormalization)

> 하나의(이상의) 테이블에 데이터를 중복해 배치하는 최적화 기법

시스템의 성능 향상, 개발 및 운영의 편의성을 위해 정규화된 데이터 모델을 `통합`, `중복`, `분리`하는 과정으로, 의도적으로 정규화 원칙을 위배하는 행위를 말한다.

### 장점

- 빠른 데이터 조회(빠른 SELECT 연산)
  - JOIN 비용이 줄어들기 때문
- 데이터 조회 쿼리가 간단해짐
  - 살펴볼 테이블이 줄어들기 때문
  - 따라서 버그 발생 가능성도 줄어듦

### 단점

- 데이터 갱신 및 삽입 비용이 높음
- 데이터 갱신 및 삽입 코드 작성이 어려움
- 데이터 간의 일관성이 저하됨
  - 어떤 쪽이 올바른 데이터인가?
- 데이터를 중복해서 저장하므로 더 많은 저장 공간 필요
- 데이터의 무결성 저하 가능성
- 입력, 수정, 삭제 쿼리에 대한 성능 저하 가능성

### 비정규화 대상

- 자주 사용되는 테이블에 접근하는 프로세스가 많거나, 항상 일정한 범위, 데이터만을 조회하는 경우
- 테이블에 지나치게 JOIN을 많이 사용하게 되어 데이터를 조회하는 것이 기술적으로 어렵거나 시간이 오래 걸려 성능이 떨어지는 경우

<br>