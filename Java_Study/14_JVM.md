# 14_JVM (Java Virtual Machine)

> 자바 가상 머신

JVM은 JRE에 포함되어 Java 프로그램을 실행시키기 위한 환경 중 하나이다. 따라서 JRE가 설치되어 있으면 JVM도 설치되어 있다.

JVM은 이름 그대로, 자바를 실행시키기 위한 가상 머신이라고 생각하면 된다.

![image](https://github.com/siwon-park/BackEnd_Study/assets/93081720/c2739645-19fa-44e3-8e9a-0360e78063e9)

**※ 컴파일(Compile)**

- 컴파일은 소스 코드를 컴퓨터가 이해하고 실행할 수 있는 형태로 변환하는 과정을 의미한다.
- 따라서, 후술하겠지만 Java를 예를 들면 .java 소스 코드가 컴파일러에 의해 클래스 파일(.class)로 변환되는 것도 컴파일 과정이고 JVM이 바이트 코드를 바이너리 코드로 변환시키는 것도 컴파일이다.

<br>

## 1. JVM의 역할과 필요성

> JVM은 왜 필요할까?

### 1) JVM의 역할

클래스 파일(.class)의 바이트 코드를 컴퓨터가 이해 가능한 바이너리 코드로 변환시켜주는 역할을 한다.

#### (1) Java 소스 코드 실행 흐름

![image](https://github.com/siwon-park/BackEnd_Study/assets/93081720/12037a36-020f-444e-a341-34bb20598c09)

<br>

### 2) JVM의 필요성

그런데 JVM이 왜 필요할까? 단순히 바이트 코드를 바이너리 코드로 바꿔준다고 해서 필요한 것은 아닐 것이다.

#### (1) 바이너리 코드

바이너리 코드란 기계어의 한 종류로, "기계가 읽을 수 있는 이진 코드"를 의미한다.

일반적으로는 개발자가 소스 코드를 작성하면, 기계에 맞춰진 컴파일러가 각 기계가 이해할 수 있는 기계어로 변환시켜주는 역할을 한다.

그런데 이는 특정 OS나 CPU에 맞춰 컴파일되기 때문에 다양한 다른 환경에서는 이 기계어를 이해할 수 없을 수도 있다.

즉, OS 종속적이기 때문에 실행이 보장되지 않을 수도 있다.

#### (2) OS 비종속적

그러나 Java로 작성한 소스 코드는 직접 운영체제로 가서 실행되는 것이 아니라, JVM을 거쳐서 운영체제와 상호작용 하는 과정을 거치게 된다.

이 때, JVM이 각 하드웨어/OS의 환경에 맞게 바이트 코드로 변환시켜주어 OS와 상관없이 독립적으로 프로그램을 실행할 수 있도록 해준다.

##### ※ 주의점

단, 여기서 착각하지 말아야 할 점이 하나 있다.

`JVM은 운영체제(OS)에 종속적이다. 따라서 각 운영체제에 맞는 JVM을 설치해줘야 한다.`

"어, 그럼 왜 OS에 종속적이지 않다고 말하나요?"라는 생각이 들 수도 있다.

OS에 종속적이지 않다는 말은 C언어를 예를 들면, 윈도우용 C 코드와 리눅스용 C 코드를 각 각 따로 작성해야 한다. 즉, OS에 맞춰서 코드를 작성/유지보수 해야 하는 것이다.

그러나 Java를 보면 윈도우든, 리눅스든 코드를 작성하고 컴파일해서 실행시키기만 하면 된다.

**즉, Java 코드를 윈도우에서 실행시키든, 리눅스에서 실행시키든 윈도우 JVM이 윈도우에 맞게 바이트 코드로 변환시켜주는 것이고, 리눅스 JVM이 리눅스에 맞게 바이트 코드로 변환시켜주는 것이다.**

<br>

### 3) JVM과 Java

JVM은 Java에만 국한되지 않는다. Java가 아닌 다른 언어도 클래스 파일만 있다면 JVM을 사용할 수 있다. 실제로 코틀린, 그루비도 JVM을 사용하고 있다.

JVM 덕분에 Java 프로그램이 OS에 종속적이지 않게 실행될 수 있다는 장점이 생겼지만, 반면에 단점도 생겼다. JVM이라는 한 단계를 더 거쳐야 하기 때문에 결국은 실행 속도면에서 느리다는 단점을 갖게 되었다.

- 컴파일 과정을 총 2번 거치게 되기 때문에 그렇다. 물론 JVM 내부에서 JIT 컴파일러가 캐싱을 사용하여 보다 효율적으로 동작하게 해놓긴 했지만 C언어의 속도를 따라잡진 못했다.

<br>

## 2. JVM의 동작 방식

### 1) JVM 아키텍처

JVM은 크게 Class Loader, Runtime Data Area, Execution Engine으로 나눌 수 있다.

![image](https://github.com/siwon-park/BackEnd_Study/assets/93081720/19d46efc-5ea9-4361-b754-e6cf6b38e704)

